---
layout: post
title: PicoCTF 2018 - Web Exploitation
---

This post will be focusing on the "Web Exploitation" challenges presented in picoCTF. Im not the expert on web exploitation, and really enjoy when things just work out, which happened here, and all of the challenges were solved except one.
All the resources for these challenges, including most of the files, you can find in [my repository](https://github.com/bear-sec/pico2018 "picoCTF2018 writeups").

# Inspect Me

Inpect this code! http://2018shell1.picoctf.com:28831 (link)

<details>
  <summary>Hints</summary>
  
    1. How do you inspect a website's code on a browser? <br>
    2. Check all the website code.
</details>

## Solution

Inspecting the page source we get the first part of the flag, and a hint that there are two more parts. 

![source](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-inspector_1.PNG)

We inspect the only two included files with this site, which are the CSS and JS files, and see the rest of the flag.

![csource](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-inspector_2.PNG)

----

# Client Side is Still Bad

I forgot my password again, but this time there doesn't seem to be a reset, can you help me? http://2018shell1.picoctf.com:55790 (link)

<details>
  <summary>Hints</summary>
  
    1. Client Side really is a bad way to do it.
</details>

## Solution

We inspect the login button and see that it verifies with a function on the client side.

![verify](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-client_1.PNG) 

The finction splits the inputted password and checks 4 bytes at a time that it equals some hardcoded string. The string is the flag.

----

# Logon

I made a website so now you can log on to! I don't seem to have the admin password. See if you can't get to the flag. http://2018shell1.picoctf.com:57252 (link)

<details>
  <summary>Hints</summary>
  
    1. Hmm it doesn't seem to check anyone's password, except for admins?
    2. How does check the admin's password?
</details>

## Solution

In this challenge were presented with a login page that we need to pass as an admin.
We are suggested that it passes any regular user login without any password check, so we try and login with a regular user. We can see that after we request the /login page, theres another request to /flag page, and to this page we see that our browser sends some values in the cookie.

![false](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-logon_1.PNG)

since we control the cookie we can change the admin value to True and try again. So we stop the outgoing requests and modify admin=True, 

![true](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-logon_3.PNG)

and voila, we got the flag!

![flag](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-logon_4.PNG)

----

# Irish Name Repo

There is a website running at http://2018shell1.picoctf.com:11899 (link). Do you think you can log us in? Try to see if you can login!

<details>
  <summary>Hints</summary>
  
    1. There doesn't seem to be many ways to interact with this, I wonder if the users are kept in a database?
</details>

## Solution

we see at this page some familiar faces but we need to login as admin. so we go to the admin login panel and try the first value that comes to mind, admin:admin.

![1](https://github.com/bear-sec/bear-sec.github.io/blob/master/images/web-irish_1.PNG)

The login fails, so we try and check for sqli, maybe it handles it poorly andwe can get an error, so we put in a single bracket, and we get a 500!

![3](https://github.com/bear-sec/bear-sec.github.io/blob/master/images/web-irish_3.PNG)

cool, now lets try a basic sqli that bypasses the password check.
In this sqli we assume that the query that the backend performs is as follows:

`'SELECT * FROM users WHERE user_name=' . user_name . ' AND password=' .pasword`

so what we can do is set the password to `a' OR '1'='1`
and the resulting query will be:

`'SELECT * FROM users WHERE user_name='admin' AND password='a' OR '1'='1'`

and what it does is retrieves the user where user_name=admin, and a TRUE statement, the password fails, but the '1'='1' succeeds so the query outputs the relevant data and we get the flag.

![4](https://github.com/bear-sec/bear-sec.github.io/blob/master/images/web-irish_4.PNG)

----

# Mr Robots

Do you see the same things I see? The glimpses of the flag hidden away? http://2018shell1.picoctf.com:29568 (link)

<details>
  <summary>Hints</summary>
  
    1. What part of the website could tell you where the creator doesn't want you to look?
</details>

## Solution

The name kinda reveals what we need to do here, but we get a link to an empty page, and the hint says, what part could tell that me where the creator doesnt want me to look, and of course its the robots.txt file. we check it and see another html

![tiextie](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-robots_1.PNG)

and the flag is in that page.

![lol](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-robots_2.PNG)

----

# No Login

Looks like someone started making a website but never got around to making a login, but I heard there was a flag if you were the admin. http://2018shell1.picoctf.com:10573 (link)

<details>
  <summary>Hints</summary>
  
    1. What is it actually looking for in the cookie?
</details>

## Solution

We get another login screen that has a flag button that supposedly will give the flag only if the one pressing it is and admin.

![2](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-nologin_2.PNG)
![3](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-nologin_3.PNG)

The hint says it has to do with the cookie, so lets check the site and see what we can do. We see that when you press the button it sends a request to /flag, and returns a jwt cookie saying were not admin, so lets try adding that we indeed are.

![5](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-nologin_5.PNG)

And it worked, we got the flag.

![1](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-nologin_1.PNG)

----

# Secret Agent

Here's a little website that hasn't fully been finished. But I heard google gets all your info anyway. http://2018shell1.picoctf.com:53383 (link)

<details>
  <summary>Hints</summary>
  
    1. How can your browser pretend to be something else?
</details>

## Solution

So we get the same page with the flag button as previous challenge and upon pressing the button we get an error message that were not google.

![notgoogle](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-agent_1.PNG)

Lets try and tell it that we are by changing the user-agent to "google"

![googlegoogle](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-agent_2.PNG)

As it turns out, google is not google, so lets try and see what user agent the google web crawler uses.

![bots](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-agent_3.PNG)

It seems hes quite fond of the bot, so we got the flag.

![flag](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-agent_4.PNG)

----

# Buttons

There is a website running at http://2018shell1.picoctf.com:7949 (link). Try to see if you can push their buttons.

<details>
  <summary>Hints</summary>
  
    1. What's different about the two buttons?
</details>

## Solution

This challenge we get a page with a button that refers us to the second button and upon pressing it we get rick rolled.

![byuton](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-buttons_4.PNG)

The hist says that we need to check whats the difference between the two, and the first one is submitted as a form via POST, and the secont one is just a href link, which will be addressed to with a GET request.

![button1](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-buttons_3.PNG)
![button2](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-buttons_2.PNG)

so we break on the button2.php request and change it from GET to POST, and get the flag.

![fleg](https://github.com/bear-sec/bear-sec.github.io/raw/master/images/web-buttons_1.PNG)

----
